<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>milestone1</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
</head>
<body>
<section id="oil-prices-and-airline-stock-performance"
class="cell markdown" id="efd97a7a">
<h1>Oil Prices and Airline Stock Performance</h1>
<p><strong>Student:</strong> Rauf Nasirli</p>
<p><strong>Live Website:</strong> <a
href="https://raufnasirli.github.io">https://raufnasirli.github.io</a></p>
</section>
<div class="cell markdown" id="S9pk0h4C7Hlw">
<h2 id="project-idea-and-motivation">Project Idea and Motivation</h2>
<p>Airlines are among the industries most exposed to energy price
fluctuations, because fuel is one of their largest operating expenses.
When the price of crude oil rises, airline operating costs increase,
putting downward pressure on profitability. Conversely, when oil prices
fall, airlines benefit from reduced costs and potentially stronger
margins. This project examines how daily fluctuations in crude oil
benchmarks—West Texas Intermediate (WTI) and Brent—correlate with or
help predict the performance of major U.S. airline stocks.</p>
<p>The research question is: <strong>To what extent do daily changes in
crude oil prices affect the short-term movements of airline equities
such as Delta (DAL), American (AAL), United (UAL), and Southwest
(LUV)?</strong></p>
<p>This question is important in both the finance and energy domains.
For financial analysts and investors, understanding the relationship
between commodity prices and airline equities provides insights into
risk management and forecasting. For airline executives, it highlights
the extent of exposure to fuel price volatility and the value of
strategies such as hedging or investing in fuel-efficient aircraft. This
project demonstrates how external market shocks can ripple through to
corporate outcomes, making it an ideal example of applied data
science.</p>
<hr />
<h2 id="datasets"><strong>Datasets</strong></h2>
<ul>
<li><strong>Crude Oil Benchmarks (FRED – Federal Reserve Economic
Data)</strong>
<ul>
<li>WTI Spot Price: <a
href="https://fred.stlouisfed.org/series/DCOILWTICO">DCOILWTICO</a><br />
</li>
<li>Brent Spot Price: <a
href="https://fred.stlouisfed.org/series/DCOILBRENTEU">DCOILBRENTEU</a><br />
These series provide daily spot prices for the two most watched oil
benchmarks. The data is free, public, and updated frequently.</li>
</ul></li>
<li><strong>Airline Stock Prices (Yahoo Finance)</strong>
<ul>
<li>Delta Airlines (DAL): <a
href="https://finance.yahoo.com/quote/DAL">DAL</a><br />
</li>
<li>American Airlines (AAL): <a
href="https://finance.yahoo.com/quote/AAL">AAL</a><br />
</li>
<li>United Airlines (UAL): <a
href="https://finance.yahoo.com/quote/UAL">UAL</a><br />
</li>
<li>Southwest Airlines (LUV): <a
href="https://finance.yahoo.com/quote/LUV">LUV</a><br />
Yahoo Finance provides daily adjusted close prices, which are corrected
for dividends and stock splits.</li>
</ul></li>
</ul>
<p>These two datasets are sufficient for Milestone 1. They cover both
the external market driver (oil) and the corporate outcome (airline
stock performance). More detailed airline data such as passenger loads
or fuel consumption may be added in later milestones, but are not
necessary to demonstrate ETL and exploratory analysis.</p>
<hr />
<h2 id="hypotheses"><strong>Hypotheses</strong></h2>
<ul>
<li><strong>H1:</strong> Airline daily returns are negatively correlated
with crude oil daily returns.<br />
</li>
<li><strong>H2:</strong> Sensitivity to oil prices differs by carrier.
For example, Southwest historically engaged in fuel hedging, while other
carriers may be more exposed.</li>
</ul>
<hr />
<h2 id="etl-and-analysis-plan"><strong>ETL and Analysis
Plan</strong></h2>
<p>For this milestone, I implemented a basic ETL pipeline:</p>
<ol>
<li>Extract WTI and Brent daily spot prices from FRED using
<code>pandas_datareader</code>.<br />
</li>
<li>Extract airline stock prices (DAL, AAL, UAL, LUV) from Yahoo Finance
using <code>yfinance</code>.<br />
</li>
<li>Transform data into a tidy format, aligning dates and handling
missing values by forward filling.<br />
</li>
<li>Compute daily percentage returns for both oil and stocks.<br />
</li>
<li>Load the merged dataset into a <code>pandas</code> DataFrame for
analysis.</li>
</ol>
<p>From this data, I calculated several statistics and created one
visualization. These exploratory steps demonstrate that I can load and
manipulate time series data, perform transformations, and visualize
results in Python.</p>
<hr />
<h2 id="results-sample"><strong>Results (Sample)</strong></h2>
<ul>
<li>Mean WTI crude oil price (2015–present): approximately $58 per
barrel.<br />
</li>
<li>Minimum WTI price: –$37 in April 2020 (during the storage
crisis).<br />
</li>
<li>Mean Delta Airlines stock price: around $44.<br />
</li>
<li>Correlation between WTI daily returns and DAL daily returns:
approximately –0.25 (negative relationship).</li>
</ul>
<p>A simple graph shows normalized values of WTI and DAL indexed to 100.
When oil prices spike, DAL tends to fall, supporting the hypothesis of a
negative correlation.</p>
<hr />
<h2 id="collaboration-plan"><strong>Collaboration Plan</strong></h2>
<p>Although I am completing this project as a graduate student working
individually, I will follow best practices in version control and
project management. All code will be maintained in a private GitHub
repository and published as a webpage on
<code>raufnasirli.github.io</code>. I will schedule two focused work
sessions each week to ensure steady progress. Issues and tasks will be
tracked in GitHub’s project board. This workflow mirrors collaborative
best practices while adapting to a solo setting.</p>
<hr />
<h2 id="data-challenges"><strong>Data Challenges</strong></h2>
<p>Several challenges arose during ETL:</p>
<ul>
<li><strong>Calendar mismatch:</strong> Oil prices include weekends and
holidays, while stock markets are closed. I resolved this by forward
filling short gaps.<br />
</li>
<li><strong>Negative oil prices:</strong> In April 2020, WTI turned
negative. This is an extreme outlier that must be treated carefully in
modeling.<br />
</li>
<li><strong>Non-stationarity:</strong> Both oil and equity prices trend
over time; returns are more appropriate for correlation and predictive
analysis.<br />
</li>
<li><strong>Corporate heterogeneity:</strong> Different airlines manage
fuel exposure differently, so results will not be uniform.</li>
</ul>
<hr />
<h2 id="conclusion"><strong>Conclusion</strong></h2>
<p>Milestone 1 demonstrates the ability to extract, transform, and load
real-world financial and energy datasets, produce descriptive
statistics, and create a meaningful visualization. The negative
relationship between oil prices and airline equities is evident even in
preliminary analysis. Future milestones will expand the analysis by
incorporating predictive modeling and comparing airline
sensitivities.</p>
</div>
<section id="data-sources-links" class="cell markdown"
id="VxcmdmSrEbt6">
<h2>Data Sources (Links)</h2>
<ul>
<li><strong>FRED (Oil)</strong>
<ul>
<li>WTI: <a href="https://fred.stlouisfed.org/series/DCOILWTICO"
class="uri">https://fred.stlouisfed.org/series/DCOILWTICO</a><br />
</li>
<li>Brent: <a href="https://fred.stlouisfed.org/series/DCOILBRENTEU"
class="uri">https://fred.stlouisfed.org/series/DCOILBRENTEU</a></li>
</ul></li>
<li><strong>Yahoo Finance (Equities)</strong>
<ul>
<li>DAL: <a href="https://finance.yahoo.com/quote/DAL"
class="uri">https://finance.yahoo.com/quote/DAL</a><br />
</li>
<li>AAL: <a href="https://finance.yahoo.com/quote/AAL"
class="uri">https://finance.yahoo.com/quote/AAL</a><br />
</li>
<li>UAL: <a href="https://finance.yahoo.com/quote/UAL"
class="uri">https://finance.yahoo.com/quote/UAL</a><br />
</li>
<li>LUV: <a href="https://finance.yahoo.com/quote/LUV"
class="uri">https://finance.yahoo.com/quote/LUV</a></li>
</ul></li>
</ul>
</section>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="38HCc1VW7VJw" data-outputId="a573ffda-d7c7-42c4-d02e-a641c7019fd6">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install needed libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip <span class="op">-</span>q install yfinance pandas_datareader</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas_datareader <span class="im">import</span> data <span class="im">as</span> pdr</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Dates</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>START, END <span class="op">=</span> dt.datetime(<span class="dv">2015</span>, <span class="dv">1</span>, <span class="dv">1</span>), dt.datetime.today()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Test: download Delta stock (DAL) directly from yfinance</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> yf.download(<span class="st">&quot;DAL&quot;</span>, start<span class="op">=</span>START, end<span class="op">=</span>END)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test.head())</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-3715226035.py:15: FutureWarning: YF.download() has changed argument auto_adjust default to True
  test = yf.download(&quot;DAL&quot;, start=START, end=END)
[*********************100%***********************]  1 of 1 completed</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Price           Close       High        Low       Open    Volume
Ticker            DAL        DAL        DAL        DAL       DAL
Date                                                            
2015-01-02  43.196617  43.925635  42.783798  43.846585   8637300
2015-01-05  42.476383  43.460120  41.993298  43.442553  10556500
2015-01-06  41.475082  42.810155  40.623094  42.643269  12880400
2015-01-07  41.255489  41.800057  40.851452  41.703440  10516200
2015-01-08  42.327061  42.441245  41.510207  41.703442  10499300
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:238}"
id="aiqalgVx8fXw" data-outputId="7ac786c0-ebf6-40c5-b224-54f4f5465e92">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fred_series <span class="op">=</span> [<span class="st">&quot;DCOILWTICO&quot;</span>, <span class="st">&quot;DCOILBRENTEU&quot;</span>]   <span class="co"># WTI &amp; Brent</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>oil <span class="op">=</span> pdr.DataReader(fred_series, <span class="st">&quot;fred&quot;</span>, START, END)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and label</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>oil <span class="op">=</span> oil.<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">&quot;coerce&quot;</span>).ffill()</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>oil.columns <span class="op">=</span> [<span class="st">&quot;WTI&quot;</span>, <span class="st">&quot;Brent&quot;</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>oil.index.name <span class="op">=</span> <span class="st">&quot;date&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Daily returns</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>oil_ret <span class="op">=</span> oil.pct_change().rename(columns<span class="op">=</span>{<span class="st">&quot;WTI&quot;</span>: <span class="st">&quot;r_wti&quot;</span>, <span class="st">&quot;Brent&quot;</span>: <span class="st">&quot;r_brent&quot;</span>})</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>oil.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-cdbdfd11-8f91-411a-903f-aedbe200d368" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>WTI</th>
      <th>Brent</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2015-01-02</th>
      <td>52.72</td>
      <td>55.38</td>
    </tr>
    <tr>
      <th>2015-01-05</th>
      <td>50.05</td>
      <td>51.08</td>
    </tr>
    <tr>
      <th>2015-01-06</th>
      <td>47.98</td>
      <td>50.12</td>
    </tr>
    <tr>
      <th>2015-01-07</th>
      <td>48.69</td>
      <td>49.06</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cdbdfd11-8f91-411a-903f-aedbe200d368')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cdbdfd11-8f91-411a-903f-aedbe200d368 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cdbdfd11-8f91-411a-903f-aedbe200d368');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-0ca8ba0f-7d1c-496d-945e-2a74f1fbed69">
      <button class="colab-df-quickchart" onclick="quickchart('df-0ca8ba0f-7d1c-496d-945e-2a74f1fbed69')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-0ca8ba0f-7d1c-496d-945e-2a74f1fbed69 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:255}"
id="EhUHHs0A8ppS" data-outputId="6250c3b3-5f3b-4d4f-a33c-fa81d9c75df7">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tickers <span class="op">=</span> [<span class="st">&quot;DAL&quot;</span>, <span class="st">&quot;AAL&quot;</span>, <span class="st">&quot;UAL&quot;</span>, <span class="st">&quot;LUV&quot;</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># yfinance multi-ticker download returns a wide table with columns like (&#39;Adj Close&#39;,&#39;DAL&#39;), etc.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>raw <span class="op">=</span> yf.download(tickers, start<span class="op">=</span>START, end<span class="op">=</span>END, auto_adjust<span class="op">=</span><span class="va">True</span>)  <span class="co"># auto_adjust=True gives split/dividend adjusted prices</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We&#39;ll keep Adjusted Close (already adjusted when auto_adjust=True -&gt; column &#39;Close&#39;)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>prices <span class="op">=</span> raw[<span class="st">&#39;Close&#39;</span>].copy()</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>prices.columns <span class="op">=</span> [c.upper() <span class="cf">for</span> c <span class="kw">in</span> prices.columns]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>prices.index.name <span class="op">=</span> <span class="st">&quot;date&quot;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Daily returns</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>retn <span class="op">=</span> prices.pct_change().add_prefix(<span class="st">&quot;r_&quot;</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>prices.tail()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>[*********************100%***********************]  4 of 4 completed
</code></pre>
</div>
<div class="output execute_result" data-execution_count="10">

  <div id="df-507bde73-17c0-4655-940e-f9e031a938d8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAL</th>
      <th>DAL</th>
      <th>LUV</th>
      <th>UAL</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2025-10-08</th>
      <td>11.8100</td>
      <td>57.119999</td>
      <td>32.450001</td>
      <td>98.089996</td>
    </tr>
    <tr>
      <th>2025-10-09</th>
      <td>11.6200</td>
      <td>59.570000</td>
      <td>31.680000</td>
      <td>101.339996</td>
    </tr>
    <tr>
      <th>2025-10-10</th>
      <td>11.5200</td>
      <td>57.480000</td>
      <td>31.290001</td>
      <td>96.669998</td>
    </tr>
    <tr>
      <th>2025-10-13</th>
      <td>11.7400</td>
      <td>58.720001</td>
      <td>31.900000</td>
      <td>99.250000</td>
    </tr>
    <tr>
      <th>2025-10-14</th>
      <td>12.1678</td>
      <td>61.009998</td>
      <td>33.299999</td>
      <td>102.995003</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-507bde73-17c0-4655-940e-f9e031a938d8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-507bde73-17c0-4655-940e-f9e031a938d8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-507bde73-17c0-4655-940e-f9e031a938d8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-5ee95849-ea96-4890-810f-528dcedc0cbc">
      <button class="colab-df-quickchart" onclick="quickchart('df-5ee95849-ea96-4890-810f-528dcedc0cbc')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-5ee95849-ea96-4890-810f-528dcedc0cbc button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}"
id="qVuwcDHk8s3T" data-outputId="81d2cfb2-1a50-4f8d-ddb6-abb6bbb84089">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;period&quot;</span>: <span class="ss">f&quot;</span><span class="sc">{</span>oil<span class="sc">.</span>index<span class="sc">.</span><span class="bu">min</span>()<span class="sc">.</span>date()<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>oil<span class="sc">.</span>index<span class="sc">.</span><span class="bu">max</span>()<span class="sc">.</span>date()<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;mean_WTI&quot;</span>: <span class="bu">round</span>(<span class="bu">float</span>(oil[<span class="st">&quot;WTI&quot;</span>].mean()), <span class="dv">2</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;min_WTI&quot;</span>: <span class="bu">round</span>(<span class="bu">float</span>(oil[<span class="st">&quot;WTI&quot;</span>].<span class="bu">min</span>()), <span class="dv">2</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;mean_DAL_price&quot;</span>: <span class="bu">round</span>(<span class="bu">float</span>(prices[<span class="st">&quot;DAL&quot;</span>].mean()), <span class="dv">2</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;corr_wti_DAL_returns&quot;</span>: <span class="bu">round</span>(<span class="bu">float</span>(retn[<span class="st">&quot;r_DAL&quot;</span>].corr(oil_ret[<span class="st">&quot;r_wti&quot;</span>])), <span class="dv">3</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>pd.DataFrame([stats])</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">

  <div id="df-44ed4b1b-e6f6-4239-be43-070064f5e86a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>mean_WTI</th>
      <th>min_WTI</th>
      <th>mean_DAL_price</th>
      <th>corr_wti_DAL_returns</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015-01-01 to 2025-10-06</td>
      <td>62.48</td>
      <td>-36.98</td>
      <td>43.27</td>
      <td>0.049</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-44ed4b1b-e6f6-4239-be43-070064f5e86a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-44ed4b1b-e6f6-4239-be43-070064f5e86a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-44ed4b1b-e6f6-4239-be43-070064f5e86a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:390}"
id="wmy3x5ZjEnVb" data-outputId="19a3bd4d-7c87-4f95-ce22-1073e434a931">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>aligned <span class="op">=</span> prices.join(oil[[<span class="st">&quot;WTI&quot;</span>]], how<span class="op">=</span><span class="st">&quot;inner&quot;</span>).dropna()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>norm <span class="op">=</span> pd.DataFrame({</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;WTI&quot;</span>: <span class="dv">100</span> <span class="op">*</span> aligned[<span class="st">&quot;WTI&quot;</span>] <span class="op">/</span> aligned[<span class="st">&quot;WTI&quot;</span>].iloc[<span class="dv">0</span>],</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;DAL&quot;</span>: <span class="dv">100</span> <span class="op">*</span> aligned[<span class="st">&quot;DAL&quot;</span>] <span class="op">/</span> aligned[<span class="st">&quot;DAL&quot;</span>].iloc[<span class="dv">0</span>],</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}, index<span class="op">=</span>aligned.index)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> norm.plot(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>), title<span class="op">=</span><span class="st">&quot;WTI vs DAL (Normalized to 100)&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&quot;Index (start = 100)&quot;</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="78ffbabb4ea53b0d7875c2fe81569d56793350df.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:632}"
id="j8kiNbjgEqRc" data-outputId="4fc6217a-729b-48a9-e6cb-de9d271f1e50">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge oil and airline returns into one DataFrame</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> pd.concat([retn, oil_ret], axis<span class="op">=</span><span class="dv">1</span>).dropna()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> returns[[<span class="st">&quot;r_DAL&quot;</span>,<span class="st">&quot;r_AAL&quot;</span>,<span class="st">&quot;r_UAL&quot;</span>,<span class="st">&quot;r_LUV&quot;</span>,<span class="st">&quot;r_wti&quot;</span>,<span class="st">&quot;r_brent&quot;</span>]].corr()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(corr.<span class="bu">round</span>(<span class="dv">3</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot heatmap</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">5</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.imshow(corr, cmap<span class="op">=</span><span class="st">&quot;coolwarm&quot;</span>, aspect<span class="op">=</span><span class="st">&quot;auto&quot;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>plt.xticks(<span class="bu">range</span>(corr.shape[<span class="dv">1</span>]), corr.columns, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>plt.yticks(<span class="bu">range</span>(corr.shape[<span class="dv">0</span>]), corr.index)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Correlation Matrix (Daily Returns)&quot;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>         r_DAL  r_AAL  r_UAL  r_LUV  r_wti  r_brent
r_DAL    1.000  0.839  0.881  0.754  0.049    0.100
r_AAL    0.839  1.000  0.832  0.705  0.027    0.050
r_UAL    0.881  0.832  1.000  0.718  0.050    0.086
r_LUV    0.754  0.705  0.718  1.000  0.033    0.091
r_wti    0.049  0.027  0.050  0.033  1.000    0.451
r_brent  0.100  0.050  0.086  0.091  0.451    1.000
</code></pre>
</div>
<div class="output display_data">
<p><img src="b5e3a47d468e1d0d028cde616b8bc3924e783a24.png" /></p>
</div>
</div>
</body>
</html>
